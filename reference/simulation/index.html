<!-- Elements added to main will be displayed on all pages -->

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Simulating atom trapping around nanostructures has never been easier. Easy to set up in 5 minutes.">
      
      
      
      
        <meta name="author" content="Jérémy Berroir & Adrien Bouscal">
      
      <link rel="shortcut icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Simulation - nanotrappy Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nanotrappy.trapping.simulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="nanotrappy Documentation" class="md-header-nav__button md-logo" aria-label="nanotrappy Documentation">
      
  <img src="../../assets/my_favicon_white.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            nanotrappy Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Simulation
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/LKB-QuantumNetworks/nanotrappy" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    LKB/nanotrappy
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
    
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../../getting-started/" class="md-tabs__link">
        Getting started
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
        
      
      <a href="../atomicsystem/" class="md-tabs__link md-tabs__link--active">
        Reference
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../../credit/" class="md-tabs__link">
        Credits
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="nanotrappy Documentation" class="md-nav__button md-logo" aria-label="nanotrappy Documentation">
      
  <img src="../../assets/my_favicon_white.svg" alt="logo">

    </a>
    nanotrappy Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/LKB-QuantumNetworks/nanotrappy" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    LKB/nanotrappy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      Getting started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/" class="md-nav__link">
      Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modeformatting/" class="md-nav__link">
      Formatting your data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../casimirpolder/" class="md-nav__link">
      On Casimir Polder interactions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    <label class="md-nav__link" for="nav-3">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../atomicsystem/" class="md-nav__link">
      Atomic system
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Simulation
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Simulation
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation" class="md-nav__link">
    nanotrappy.trapping.simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation" class="md-nav__link">
    Simulation
  </a>
  
    <nav class="md-nav" aria-label="Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.lmbdas_modes" class="md-nav__link">
    lmbdas_modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.exists_in_past_simulations" class="md-nav__link">
    exists_in_past_simulations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.set_current_params" class="md-nav__link">
    set_current_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.set_wavelengths_indices" class="md-nav__link">
    set_wavelengths_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.total_potential" class="md-nav__link">
    total_potential()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.parse_lmbdas" class="md-nav__link">
    parse_lmbdas()
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../trap/" class="md-nav__link">
      Trap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../beam/" class="md-nav__link">
      Beam
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../viz/" class="md-nav__link">
      Visualization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Credits
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Credits" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Credits
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../credit/" class="md-nav__link">
      Credits
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation" class="md-nav__link">
    nanotrappy.trapping.simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation" class="md-nav__link">
    Simulation
  </a>
  
    <nav class="md-nav" aria-label="Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.lmbdas_modes" class="md-nav__link">
    lmbdas_modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.exists_in_past_simulations" class="md-nav__link">
    exists_in_past_simulations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.set_current_params" class="md-nav__link">
    set_current_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.set_wavelengths_indices" class="md-nav__link">
    set_wavelengths_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.Simulation.total_potential" class="md-nav__link">
    total_potential()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nanotrappy.trapping.simulation.parse_lmbdas" class="md-nav__link">
    parse_lmbdas()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Simulation</h1>
                
                <div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#nanotrappy.trapping.simulation" id="nanotrappy.trapping.simulation" style="visibility: hidden; position: absolute;">
        <a class="headerlink" href="#nanotrappy.trapping.simulation" title="Permanent link">&para;</a></h2>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation">

        <code>Simulation</code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation" title="Permanent link">&para;</a></h2>
<div class="doc doc-contents ">
<p>Simulation class. Bundle of all the predefined objects that are needed for computing the potentials.</p>
<p><strong>Attributes:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>atomic</code></td>
<td><code>system (atomicsytem</code></td>
<td>
<p>Atomic system that we want to trap (has an atom and a hyperfine level as attributes among others)</p>
</td>
</tr>
<tr>
<td><code>material</code></td>
<td><code>material</code></td>
<td>
<p>See NanoTrap.utils.materials for available materials. They can be easily added by the user.</p>
</td>
</tr>
<tr>
<td><code>trap</code></td>
<td><code>trap</code></td>
<td>
<p>trap object with the beams used for the specified trap scheme.</p>
</td>
</tr>
<tr>
<td><code>surface</code></td>
<td><code>surface</code></td>
<td>
<p>Plane or Cylinder, to get a local mask for the CP interaction (always computed as -C3/r**3).</p>
</td>
</tr>
<tr>
<td><code>data_folder</code></td>
<td><code>str</code></td>
<td>
<p>Folder where your modes with the right formatting are saved. The class will fetch the modes corresponding to the trap in this folder (if they exist).</p>
</td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation.lmbdas_modes">

        <code class="highlight">
lmbdas_modes        </code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation.lmbdas_modes" title="Permanent link">&para;</a></h3>
<div class="doc doc-contents ">
<p>Returns a list of all the wavelengths available in the modes present in the data folder</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Passed as property so it is updated anytime the trap is changed</p>
</div>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation.exists_in_past_simulations">

        <code class="highlight language-python">
exists_in_past_simulations<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation.exists_in_past_simulations" title="Permanent link">&para;</a></h3>
<div class="doc doc-contents ">
<p>This method checks if the simulation about to be run has already been saved in the "simulations" folder, by checking the .json parameter files.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(tuple)</code></td>
<td>
<p>tuple containing:</p>
<div class="highlight">
<pre><span></span><code>- bool : True if simulation already exists, False otherwise.
- str : Name of the file if the simulation has already been run.
</code></pre>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>nanotrappy\trapping\simulation.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">exists_in_past_simulations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""This method checks if the simulation about to be run has already been saved in the "simulations" folder, by checking the .json parameter files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): tuple containing:</span>

<span class="sd">            - bool : True if simulation already exists, False otherwise.</span>
<span class="sd">            - str : Name of the file if the simulation has already been run.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_current_params</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations"</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations"</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".json"</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations/"</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>

            <span class="c1"># initializing compare keys</span>
            <span class="n">comp_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Atomic system"</span><span class="p">,</span> <span class="s2">"Material"</span><span class="p">,</span> <span class="s2">"Trap wavelengths"</span><span class="p">,</span> <span class="s2">"Considered state"</span><span class="p">,</span> <span class="s2">"Geometry"</span><span class="p">,</span> <span class="s2">"Surface"</span><span class="p">]</span>

            <span class="c1"># Compare Dictionaries on certain keys using all()</span>
            <span class="n">res</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">comp_keys</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"npy"</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">E_file</span> <span class="o">=</span> <span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"E_field.npy"</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vecs_file</span> <span class="o">=</span> <span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"vecs.npy"</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation.save">

        <code class="highlight language-python">
save<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation.save" title="Permanent link">&para;</a></h3>
<div class="doc doc-contents ">
<p>Saves both the parameters dictionnary into a .json file and the potentials attribute into a .npy.</p>
<details class="quote">
          <summary>Source code in <code>nanotrappy\trapping\simulation.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Saves both the parameters dictionnary into a .json file and the potentials attribute into a .npy."""</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">already_saved</span><span class="p">:</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">"Time of simulation"</span><span class="p">]</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span> <span class="s2">"_"</span><span class="p">)</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">":"</span><span class="p">,</span> <span class="s2">"_"</span><span class="p">)</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="s2">"_"</span><span class="p">)</span>

        <span class="n">filename_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">".json"</span>
        <span class="n">filename_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">".npy"</span>
        <span class="n">E_filename_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"E_field.npy"</span>
        <span class="n">vecs_filename_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"/simulations/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"vecs.npy"</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename_params</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename_params</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># Guard against race condition</span>
                <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>
                    <span class="k">raise</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename_params</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">potentials</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">E_filename_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Etot</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">vecs_filename_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vecs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">already_saved</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"This simulation has already been saved, see </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation.set_current_params">

        <code class="highlight language-python">
set_current_params<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation.set_current_params" title="Permanent link">&para;</a></h3>
<div class="doc doc-contents ">
<p>Sets a dictionnary with all the relevant parameters of the Simulation object and returns it.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dict </code></td>
<td>
<p>parameters of the simulation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>nanotrappy\trapping\simulation.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">set_current_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Sets a dictionnary with all the relevant parameters of the Simulation object and returns it.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict : parameters of the simulation</span>
<span class="sd">    """</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">beam</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trap</span><span class="o">.</span><span class="n">beams</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="p">,</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_lmbda</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="p">,</span> <span class="n">beam</span><span class="o">.</span><span class="n">get_power</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">refcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">refcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">refcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">refcheck</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">lambda1pair1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" nm"</span>
    <span class="n">power1pair1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">mW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" mW"</span>
    <span class="n">lambda2pair1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" nm"</span>
    <span class="n">power2pair1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">mW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" mW"</span>

    <span class="n">lambda1pair2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" nm"</span>
    <span class="n">power1pair2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">mW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" mW"</span>
    <span class="n">lambda2pair2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">nm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" nm"</span>
    <span class="n">power2pair2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">mW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" mW"</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M:%S"</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"Time of simulation"</span><span class="p">:</span> <span class="n">current_time</span><span class="p">,</span>
        <span class="s2">"Atomic system"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"species"</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicsystem</span><span class="o">.</span><span class="n">atom</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s2">"groundstate"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicsystem</span><span class="o">.</span><span class="n">groundstate</span><span class="p">),</span>
            <span class="s2">"hyperfine level"</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicsystem</span><span class="o">.</span><span class="n">f</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s2">"Material"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">),</span>
        <span class="s2">"Trap wavelengths"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"lambda 1 pair 1"</span><span class="p">:</span> <span class="n">lambda1pair1</span><span class="p">,</span>
            <span class="s2">"lambda 2 pair 1"</span><span class="p">:</span> <span class="n">lambda2pair1</span><span class="p">,</span>
            <span class="s2">"lambda 1 pair 2"</span><span class="p">:</span> <span class="n">lambda1pair2</span><span class="p">,</span>
            <span class="s2">"lambda 2 pair 2"</span><span class="p">:</span> <span class="n">lambda2pair2</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">"Trap powers"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"power 1 pair 1"</span><span class="p">:</span> <span class="n">power1pair1</span><span class="p">,</span>
            <span class="s2">"power 2 pair 1"</span><span class="p">:</span> <span class="n">power2pair1</span><span class="p">,</span>
            <span class="s2">"power 1 pair 2"</span><span class="p">:</span> <span class="n">power1pair2</span><span class="p">,</span>
            <span class="s2">"power 2 pair 2"</span><span class="p">:</span> <span class="n">power2pair2</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">"Considered state"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicsystem</span><span class="o">.</span><span class="n">state</span><span class="p">),</span>
        <span class="s2">"Geometry"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"2D"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">"2D plane"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">isPlane</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">"2D orthogonal coord"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">normal_coord</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">isPlane</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">"1D"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">"1D axis"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">isAxis</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">"1D coord1"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">isAxis</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">"1D coord2"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">isAxis</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">"Surface"</span><span class="p">:</span> <span class="p">[</span><span class="n">surface</span><span class="o">.</span><span class="n">params</span> <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">],</span>
        <span class="s2">"Data_folder"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"[INFO] Simulation parameters set"</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation.set_wavelengths_indices">

        <code class="highlight language-python">
set_wavelengths_indices<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation.set_wavelengths_indices" title="Permanent link">&para;</a></h3>
<div class="doc doc-contents ">
<p>Compares the wavelengths of the beams specified for the trap with the wavelengths of the available modes in the data folder and returns the list of the file indices that correspond.
The wavelengths are rounded to 0.01 nm before comparison.</p>
<div class="highlight">
<pre><span></span><code>!!! note
    Passed as property so it is updated anytime the trap is changed

!!! raises
    ValueError: If at least one wavelength wanted for the trap cannot be found in the data folder.
</code></pre>
</div>
<details class="quote">
          <summary>Source code in <code>nanotrappy\trapping\simulation.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">set_wavelengths_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Compares the wavelengths of the beams specified for the trap with the wavelengths of the available modes in the data folder and returns the list of the file indices that correspond.</span>
<span class="sd">    The wavelengths are rounded to 0.01 nm before comparison.</span>

<span class="sd">        Note:</span>
<span class="sd">            Passed as property so it is updated anytime the trap is changed</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If at least one wavelength wanted for the trap cannot be found in the data folder.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trap</span><span class="o">.</span><span class="n">lmbdas</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_modes</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-11</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths_indices</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"Demanded wavelengths for trap not found in data folder, the possible wavelengths are the following: "</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lmbdas_modes</span><span class="p">),</span>
            <span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="nanotrappy.trapping.simulation.Simulation.total_potential">

        <code class="highlight language-python">
total_potential<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.Simulation.total_potential" title="Permanent link">&para;</a></h3>
<div class="doc doc-contents ">
<p>Uses the potentials attributes of the Simulation object for each beam to return their weighted sum with the specified powers</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>total potential </code></td>
<td>
<p>array with shape(length coordinate 1,length coordinate 2,number of possbile mf states)</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>nanotrappy\trapping\simulation.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">total_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Uses the potentials attributes of the Simulation object for each beam to return their weighted sum with the specified powers</span>

<span class="sd">    Returns:</span>
<span class="sd">        total potential : array with shape(length coordinate 1,length coordinate 2,number of possbile mf states)</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_potential_noCP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">"float"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">"complex"</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">potential</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potentials</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_potential_noCP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_potential_noCP</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">trap</span><span class="o">.</span><span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_power</span><span class="p">()</span> <span class="o">*</span> <span class="n">potential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_vecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trap</span><span class="o">.</span><span class="n">beams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_power</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">norm_total_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_vecs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">number_mf_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_vecs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_mf_levels</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_vecs</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norm_total_vecs</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_potential_noCP</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">CP</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_mf_levels</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="nanotrappy.trapping.simulation.parse_lmbdas">

        <code class="highlight language-python">
parse_lmbdas<span class="p">(</span><span class="n">data_folder</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#nanotrappy.trapping.simulation.parse_lmbdas" title="Permanent link">&para;</a></h2>
<div class="doc doc-contents ">
<p>This function opens all the .npy file of the given data_folder and stores the wavelengths of the modes in an array.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data_folder</code></td>
<td><code>str</code></td>
<td>
<p>Absolute path of the folder containing the computed available modes.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>array </code></td>
<td>
<p>np array with all the available wavelengths.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>nanotrappy\trapping\simulation.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">parse_lmbdas</span><span class="p">(</span><span class="n">data_folder</span><span class="p">):</span>
    <span class="sd">"""This function opens all the .npy file of the given data_folder and stores the wavelengths of the modes in an array.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_folder (str): Absolute path of the folder containing the computed available modes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        array : np array with all the available wavelengths.</span>
<span class="sd">    """</span>
    <span class="n">lmbdas_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data_folder</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".npy"</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data_folder</span> <span class="o">+</span> <span class="s2">"//"</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lmbdas_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lmbdas_modes</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lmbdas_modes</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!-- Copyright and theme information -->
      <div class="md-footer-copyright">
        
        <div class="md-footer-copyright__highlight">Copyright &copy; 2020-2021 Jérémy Berroir & Adrien Bouscal</div>
         powered by
        <a href="https://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a
          href="https://squidfunk.github.io/mkdocs-material/"
          title="Material for MkDocs"
        >
          Material for MkDocs</a
        >
      </div>
        
    </div>
  </div>
</footer>

    </div>
    
      <script src="../../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.sections', 'navigation.tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>